<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html">
  <title>plTenjin FAQ</title>
  <meta name="generator" content="kwaser">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <link rel="stylesheet" href="docstyle.css" type="text/css">
 </head>
 <body>

  <blockquote>
   <div class="mainbody">

    <div align="left"><h1>plTenjin FAQ</h1></div>
    <div align="left">
      last update: $Date$<br>
    </div>

<p>Release:	$Release$
</p>
<p>Table of contents:
<ul>
  <li><a href="#faq-basic">Basic</a>
  <ul>
    <li><a href="#faq-syntax-error">I got an SyntaxError exception.</a>
    </li>
    <li><a href="#faq-delete-newline">'[== $_content =]' includes extra newline at end. Can I delete it?</a>
    </li>
    <li><a href="#faq-change-funcname">Can I change 'escape()' function name?</a>
    </li>
    <li><a href="#faq-change-bufname">Can I change '@_buf' variable name?</a>
    </li>
    <li><a href="#faq-default-value">Is it able to specify default value if a variable is not set?</a>
    </li>
  </ul>
  </li>
  <li><a href="#faq-template">Template</a>
  <ul>
    <li><a href="#faq-template-args">Is it possible to specify variables passed to template?</a>
    </li>
    <li><a href="#faq-exprpat">Is it able to change embedded expression pattern?</a>
    </li>
    <li><a href="#faq-m17n">Does plTenjin support M17N?</a>
    </li>
  </ul>
  </li>
  <li><a href="#faq-layout">Layout Template</a>
  <ul>
    <li><a href="#faq-change-layout-template">Can I change layout template name in a template file?</a>
    </li>
    <li><a href="#faq-nested-layout-template">Can I nest layout templates for any depth?</a>
    </li>
    <li><a href="#faq-diable-layout">Can I disable default layout template for a certain template?</a>
    </li>
    <li><a href="#faq-template-inheritance">Is Django-like "Template Inheritance" supported?</a>
    </li>
  </ul>
  </li>
  <li><a href="#faq-performance">Performance</a>
  <ul>
    <li><a href="#How fast is plTenjin compared with other solutions?">How fast is plTenjin compared with other solutions?</a>
    </li>
    <li><a href="#faq-why-so-fast">Why plTenjin is so fast?</a>
    </li>
    <li><a href="#faq-performance-tuning">Is there any way to get more speed?</a>
    </li>
  </ul>
  </li>
</ul>
</p>
<a name="faq-basic"></a>
<h2 class="section1">Basic</h2>
<a name="faq-syntax-error"></a>
<h3 class="section2">I got an SyntaxError exception.</h3>
<p>Command-line option '-z' checks syntax of template file.
You should check template by it.
</p>
<p>Also command-line option '-w' is useful. This option enables 'use strict;' of Perl.
</p>
<a name="ex1.plhtml"></a>
<div class="program_caption">
File 'ex1.plhtml':</div>
<pre class="program">&lt;ul&gt;
&lt;?pl for $i (1..10) { ?&gt;
  &lt;li&gt;[=$i=]&lt;/li&gt;
&lt;?pl } ?&gt;
&lt;/ul&gt;
</pre>
<div class="terminal_caption">
Result:</div>
<pre class="terminal">$ pltenjin <strong>-z</strong> ex1.plhtml
*** data/faq/ex1.plhtml - ok
$ pltenjin <strong>-wz</strong> ex1.plhtml
*** data/faq/ex1.plhtml - NG
Global symbol "$i" requires explicit package name at ex1.plhtml line 2.
Global symbol "$i" requires explicit package name at ex1.plhtml line 3.
ex1.plhtml had compilation errors.
</pre>
<br>


<a name="faq-delete-newline"></a>
<h3 class="section2">'[== $_content =]' includes extra newline at end. Can I delete it?</h3>
<p>Yes. You can use '&lt;?pl echo($_content); ?&gt;' or '<code>&lt;?pl push(@_buf, $_context); ?&gt;</code> or '<code>[== $_context ==]</code>' instead of '<code>[== $_context =]</code>'.
</p>
<a name="ex2-layout.plhtml"></a>
<div class="program_caption">
File 'ex2-layout.plhtml':</div>
<pre class="program">&lt;!-- --&gt;
<strong>[== $_content =]</strong>
&lt;!-- --&gt;

&lt;!-- --&gt;
<strong>[== $_content ==]</strong>
&lt;!-- --&gt;

&lt;!-- --&gt;
<strong>&lt;?pl push(@_buf, $_content); ?&gt;</strong>
&lt;!-- --&gt;
</pre>
<a name="ex2-content.plhtml"></a>
<div class="program_caption">
File 'ex2-content.plhtml':</div>
<pre class="program">foo
bar
baz
</pre>
<a name="ex2_removenl.result"></a>
<div class="terminal_caption">
Result:</div>
<pre class="terminal">$ pltenjin --layout=ex2-layout.plhtml ex2-content.plhtml
&lt;!-- --&gt;
foo
bar
baz

&lt;!-- --&gt;

&lt;!-- --&gt;
foo
bar
baz
&lt;!-- --&gt;

&lt;!-- --&gt;
foo
bar
baz
&lt;!-- --&gt;
</pre>
<br>


<a name="faq-change-funcname"></a>
<h3 class="section2">Can I change 'escape()' function name?</h3>
<p>Yes. You can change them by setting 'escapefunc' option for Tenjin::Template::new() or Tenjin::Engine::new().
</p>
<a name="ex3.pl"></a>
<div class="program_caption">
File 'ex3.pl':</div>
<pre class="program">use Tenjin;
use strict;
my $engine = new Tenjin::Engine(<strong>{escapefunc=&gt;'HTML::Entities::encode_entities'}</strong>);
my $template = $engine-&gt;get_template('ex3.plhtml');
print $template-&gt;{script};
</pre>
<a name="ex3.plhtml"></a>
<div class="program_caption">
File 'ex3.plhtml':</div>
<pre class="program">Hello [=$name=]!
</pre>
<a name="ex3_escapefunc1.result"></a>
<div class="program_caption">
Result:</div>
<pre class="program">$ perl ex3.pl
my @_buf = (); push(@_buf, q`Hello `, <strong>HTML::Entities::encode_entities</strong>($name), q`!
`, ); join('', @_buf);
</pre>
<p>Command-line option '--escapefunc=<em>name</em>' is equivarent to the above.
</p>
<a name="ex3_escapefunc2.result"></a>
<div class="program_caption">
Result:</div>
<pre class="program">$ pltenjin -s <strong>--escapefunc=HTML::Entities::encode_entities</strong> ex3.plhtml
my @_buf = (); push(@_buf, q`Hello `, <strong>HTML::Entities::encode_entities</strong>($name), q`!
`, ); join('', @_buf);
</pre>
<br>


<a name="faq-change-bufname"></a>
<h3 class="section2">Can I change '@_buf' variable name?</h3>
<p>No. Variable name '@_buf' should not and will never be changed.
</p>
<br>


<a name="faq-default-value"></a>
<h3 class="section2">Is it able to specify default value if a variable is not set?</h3>
<p>Yes, by <code>$_context-&gt;{<em>varname</em>}</code>.
It is able to check whether value is set or not by inspecting special variable '<code>$_context</code>' which represents context values.
</p>
<a name="ex4.plhtml"></a>
<div class="program_caption">
File 'ex4.plhtml':</div>
<pre class="program">&lt;?pl <strong>my $user = defined($_context-&gt;{'user'}) ? $_context-&gt;{'user'} : 'Guest'; </strong> ?&gt;
Hello [=<strong>$user</strong>=]!
</pre>
<div class="terminal_caption">
Result:</div>
<pre class="terminal">$ pltenjin -c 'user=&gt;"Tenjin"' ex4.plhtml
Hello Tenjin!
$ pltenjin ex4.plhtml
Hello Guest!
</pre>
<br>


<br>


<a name="faq-template"></a>
<h2 class="section1">Template</h2>
<a name="faq-template-args"></a>
<h3 class="section2">Is it possible to specify variables passed to template?</h3>
<p>Yes. You can specify template arguments by '<code>&lt;?pl #@ARGS arg1, arg2, arg3 ?&gt;</code>'.
</p>
<a name="ex5.plhtml"></a>
<div class="program_caption">
File 'ex5-layout.plhtml'</div>
<pre class="program">&lt;?xml version="1.0 ?&gt;
<strong>&lt;?pl #@ARGS x, y ?&gt;</strong>
&lt;p&gt;
  x = [=$x=]
  y = [=$y=]
  z = [=$z=]
&lt;/p&gt;
</pre>
<p>Template arguments line is converted into local variable assignment statements.
</p>
<a name="ex5_template_args.source"></a>
<div class="terminal_caption">
Source code</div>
<pre class="terminal">$ pltenjin -s ex5.plhtml
my @_buf = (); push(@_buf, q`&lt;?xml version="1.0 ?&gt;
`, ); my $x = $_context-&gt;{x}; my $y = $_context-&gt;{y}; 
push(@_buf, q`&lt;p&gt;
  x = `, escape($x), q`
  y = `, escape($y), q`
  z = `, escape($z), q`
&lt;/p&gt;
`, ); join('', @_buf);
</pre>
<p>Undeclared arguments are not available even when they are passed via context object.
</p>
<a name="ex5_template_args.result"></a>
<div class="terminal_caption">
Result:</div>
<pre class="terminal">$ pltenjin -wc 'x=&gt;10, y=&gt;20' ex5.plhtml
*** Error: ex5.plhtml
Global symbol "$z" requires explicit package name at (eval 4) line 6.
</pre>
<br>


<a name="faq-exprpat"></a>
<h3 class="section2">Is it able to change embedded expression pattern?</h3>
<p>Yes, you can create subclass of Template class and override embedded expression pattern.
</p>
<a name="ex6-expr-pattern.plhtml"></a>
<div class="program_caption">
ex6-expr-pattern.plhtml:</div>
<pre class="program">&lt;p&gt;HTML escaped: [|$value|]&lt;/p&gt;
&lt;p&gt;not escaped:  [:$value:]&lt;/p&gt;
</pre>
<a name="ex6-expr-pattern.pl"></a>
<div class="program_caption">
ex6-expr-pattern.pl:</div>
<pre class="program">use strict;
use Tenjin;

##
## template class
##
package MyTemplate;

@MyTemplate::ISA = ('Tenjin::Template');

## '[|expr|]' escapes HTML and '[:expr:]' doesn't
my $EXPR_PATTERN = qr/\[(?:\|(.*?)\||\:(.*?)\:)(-)?\]/s;

### return embedded expression pattern
sub <strong>expr_pattern</strong> {
    my $this = shift;
    return $EXPR_PATTERN;
}

## return expression string and flag whether escape or not
sub <strong>get_expr_and_escapeflag</strong> {
    my $this = shift;
    my ($m1, $m2, $m3) = @_;
    my $expr = $m1 || $m2;
    my $escapeflag = $m1 ? 1 : 0;
    my $remove_newline = $m3 ? 1 : 0;
    return $expr, $escapeflag, $remove_newline
}

##
## test program
##
package main;
if (__FILE__ == $0) {
    my $context = { value =&gt; 'AAA&amp;BBB' };
    my $engine = new Tenjin::Engine({<strong>templateclass=&gt;'MyTemplate'</strong>});
    my $output = $engine-&gt;render('ex6-expr-pattern.plhtml', $context);
    print $output;
}
</pre>
<a name="ex6_expr_pattern.result"></a>
<div class="terminal_caption">
Result:</div>
<pre class="terminal">$ perl ex6-expr-pattern.pl
&lt;p&gt;HTML escaped: AAA&amp;amp;BBB&lt;/p&gt;
&lt;p&gt;not escaped:  AAA&amp;BBB&lt;/p&gt;
</pre>
<br>


<a name="faq-m17n"></a>
<h3 class="section2">Does plTenjin support M17N?</h3>
<p>No, but it is easy to support M17N.
The point is:
</p>
<ul type="disc">
<li>Change cache filename according to language.
   For example, create cache file 'file.plhtml.en.cache', 'file.plhtml.fr.cache', 'file.plhtml.it.cache', and so on from template file 'file.plhtml'.
</li>
<li>Create Engine object for each language.
</li>
<li>(optinal) Use preprocessing for performance reason.
</li>
</ul>
<p>The following is an example to generate M17N pages from a template file.
</p>
<a name="ex7-m18n.plhtml"></a>
<div class="program_caption">
ex7-m18n.plhtml:</div>
<pre class="program">&lt;div&gt;
&lt;?PL ## '_()' represents translator method ?&gt;
 &lt;p&gt;<strong>[*=_('Hello')=*]</strong> [=$username=]!&lt;/p&gt;
&lt;/div&gt;
</pre>
<a name="ex7-m18n.pl"></a>
<div class="program_caption">
ex7-m18n.pl:</div>
<pre class="program">use strict;
use Tenjin;


##
## message catalog to translate message
##
my $MESSAGE_CATALOG = {
  'en' =&gt; { 'Hello'   =&gt; 'Hello',
            'Good bye'=&gt; 'Good bye', },
  'fr' =&gt; { 'Hello'   =&gt; 'Bonjour',
            'Good bye'=&gt; 'Au revoir', },
};

sub _ {
    my ($message_key, $lang) = @_;
    $lang = $::LANG || 'en' unless $lang;
    my $dict = $MESSAGE_CATALOG-&gt;{$lang};
    return $message_key unless $dict;
    return $dict-&gt;{$message_key} || $message_key;
}


##
## engine class which supports M17N
##
package M17NEngine;

@M17NEngine::ISA = ('Tenjin::Engine');

## get 'lang' option
sub new {
    my $class = shift;
    my $this = $class-&gt;SUPER::new(@_);
    my $opts = $_[0] || {};
    $this-&gt;{lang} = $opts-&gt;{lang} || 'en';
    return $this;
}


## change cache flename to 'file.html.lang.cache'
<strong>sub cachename {</strong>
    <strong>my $this = shift;</strong>
    <strong>my ($filename) = @_;</strong>
    <strong>return "$filename.$this-&gt;{lang}.cache"</strong>
<strong>}</strong>

## set/clear $::LANG before/after rendering
sub render {
    my $this = shift;
    $::LANG = $this-&gt;{lang};
    my $output = $this-&gt;SUPER::render(@_);
    $::LANG = undef;
    return $output;
}


##
## test program
##
package main;
if ($0 == __FILE__) {

    my $template_name = 'ex7-m18n.plhtml';
    my $context = { username=&gt;'World' };

    ## engine for english
    my $engine = <strong>new M17NEngine</strong>({ preprocess=&gt;1 });
    my $output = $engine-&gt;render($template_name, $context);
    print "--- lang: $engine-&gt;{lang} ---\n";
    print $output, "\n";

    ## engine for english
    my $engine = new <strong>M17NEngine</strong>({ preprocess=&gt;1, <strong>lang=&gt;'fr'</strong> });
    my $output = $engine-&gt;render($template_name, $context);
    print "--- lang: $engine-&gt;{lang} ---\n";
    print $output;

}
</pre>
<a name="ex7_m18n.result"></a>
<div class="terminal_caption">
Result:</div>
<pre class="terminal">$ perl ex7-m18n.pl
--- lang: en ---
&lt;div&gt;
 &lt;p&gt;<strong>Hello</strong> World!&lt;/p&gt;
&lt;/div&gt;

--- lang: fr ---
&lt;div&gt;
 &lt;p&gt;<strong>Bonjour</strong> World!&lt;/p&gt;
&lt;/div&gt;
</pre>
<p>plTenjin doesn't provide M17N feature directly because requirements for M17N are
different for each applications or frameworks.
Some applications or frameworks adapt GetText library and others use its original M17N library.
What plTenjin should do is not to provide M17N feature but to show an example to support M17N.
</p>
<br>


<br>


<a name="faq-layout"></a>
<h2 class="section1">Layout Template</h2>
<a name="faq-change-layout-template"></a>
<h3 class="section2">Can I change layout template name in a template file?</h3>
<p>Yes. If you set <code>$_context-&gt;{_layout}</code>,
its value is regarded as layout template name.
</p>
<ul type="disc">
<li>You can specify template file name (ex. 'user_list.plhtml') or template short name (ex. :list).
</li>
<li>If you set 1 to '$_context-&gt;{_layout}', default layout template name is used instead.
</li>
<li>It is able to N-th level nested template.
</li>
</ul>
<p>See the next section for details.
</p>
<br>


<a name="faq-nested-layout-template"></a>
<h3 class="section2">Can I nest layout templates for any depth?</h3>
<p>Yes. If you set <code>$_context-&gt;{_layout}</code>,
you can nest layout templates in any depth.
</p>
<p>The following example shows that:
</p>
<ul type="disc">
<li>'ex7-content.plhtml' uses 'ex7-mylayout.plhtml' as layout template.
</li>
<li>'ex7-mylayout.plhtml' uses 'ex7-baselayout.plhtml' as layout template.
</li>
</ul>
<a name="ex8-content.plhtml"></a>
<div class="program_caption">
File 'ex8-content.plhtml':</div>
<pre class="program">&lt;?pl $_context-&gt;{'title'} = 'Changing Layout Template Test'; ?&gt;
&lt;?pl ## specify layout template name ?&gt;
<strong>&lt;?pl $_context-&gt;{'_layout'} = 'ex8-mylayout.plhtml'; ?&gt;</strong>
foo
bar
baz
</pre>
<a name="ex8-mylayout.plhtml"></a>
<div class="program_caption">
File 'ex8-mylayout.plhtml':</div>
<pre class="program">&lt;?pl ## use default layout template name ?&gt;
<strong>&lt;?pl $_context-&gt;{'_layout'} = 1; ?&gt;</strong>
&lt;div id="content"&gt;
<strong>[== $_content ==]</strong>
&lt;/div&gt;
</pre>
<a name="ex8-baselayout.plhtml"></a>
<div class="program_caption">
File 'ex8-baselayout.plhtml':</div>
<pre class="program">&lt;html&gt;
  &lt;body&gt;
&lt;?pl my $title = $_context-&gt;{'title'}; ?&gt;
&lt;?pl if ($title) { ?&gt;
    &lt;h1&gt;[=$title=]&lt;/h1&gt;
&lt;?pl } ?&gt;
<strong>[== $_content ==]</strong>
  &lt;/body&gt;
&lt;/html&gt;
</pre>
<a name="ex8_changelayout.result"></a>
<div class="terminal_caption">
Result:</div>
<pre class="terminal">$ pltenjin -w --layout=ex8-baselayout.plhtml ex8-content.plhtml
&lt;html&gt;
  &lt;body&gt;
    &lt;h1&gt;Changing Layout Template Test&lt;/h1&gt;
&lt;div id="content"&gt;
foo
bar
baz
&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>
<br>


<a name="faq-diable-layout"></a>
<h3 class="section2">Can I disable default layout template for a certain template?</h3>
<p>Yes. If you set 0 to $_context-&gt;{_layout}, default layout template will not be applied.
</p>
<br>


<a name="faq-template-inheritance"></a>
<h3 class="section2">Is Django-like "Template Inheritance" supported?</h3>
<p>No, but you can emulate it partially by combination of template capturing and '$_context-&gt;{_layout}'.
</p>
<a name="ex9-baselayout.plhtml"></a>
<div class="program_caption">
File 'ex9-baselayout.plhtml':</div>
<pre class="program">&lt;html&gt;
 &lt;body&gt;

&lt;?pl ## if '$_context-&gt;{header_part}' is defined then print it, ?&gt;
&lt;?pl ## else print default header part. ?&gt;
  &lt;div id="header"&gt;
<strong>&lt;?pl start_placeholder('header_part'); ?&gt;</strong>
   &lt;img src="img/logo.png" alt="logo" ?&gt;
<strong>&lt;?pl stop_placeholder(); ?&gt;</strong>
  &lt;/div&gt;

&lt;?pl ## main content part ?&gt;
  &lt;div id="content"&gt;
[== $content_part ==]
  &lt;/div&gt;

&lt;?pl ## if '$_context-&gt;{footer_part} is defined then print it, ?&gt;
&lt;?pl ## else print default footer part. ?&gt;
  &lt;div id="footer"&gt;
<strong>&lt;?pl start_placeholder('footer_part'); ?&gt;</strong>
   &lt;hr /&gt;
   &lt;em&gt;webmaster@example.com&lt;/em&gt;
<strong>&lt;?pl stop_placeholder(); ?&gt;</strong>
  &lt;/div&gt;
  
 &lt;/body&gt;
&lt;/html&gt;
</pre>
<a name="ex9-customlayout.plhtml"></a>
<div class="program_caption">
File 'ex9-customlayout.plhtml':</div>
<pre class="program">&lt;?pl ## '$_context-&gt;{_layout}' is equivarent to '{% extends "foobar.html" %}' ?&gt;
&lt;?pl ## in Django template engine. ?&gt;
<strong>&lt;?pl $_context-&gt;{_layout} = 'ex9-baselayout.plhtml'; ?&gt;</strong>

&lt;?pl ## you can override header or footer by capturing. ?&gt;
<strong>&lt;?pl start_capture('footer_part'); ?&gt;</strong>
&lt;address style="text-align:right"&gt;
  copyright&amp;copy; 2007 kuwata-lab all rights reserved&lt;br /&gt;
  &lt;a href="webmaster&amp;#64;kuwata-lab.com"&gt;webmaster&amp;#64;kuwata-lab.com&lt;/a&gt;
&lt;/address&gt;
<strong>&lt;?pl stop_capture(); ?&gt;</strong>
</pre>
<a name="ex9-content.plhtml"></a>
<div class="program_caption">
File 'ex9-content.plhtml':</div>
<pre class="program">&lt;?pl ## '$_context-&gt;{_layout}' is equivarent to '{% extends "foobar.html" %}' ?&gt;
&lt;?pl ## in Django template engine. ?&gt;
<strong>&lt;?pl $_context-&gt;{_layout} = 'ex9-customlayout.plhtml'; ?&gt;</strong>

&lt;?pl ## main content part ?&gt;
<strong>&lt;?pl start_capture('content_part'); ?&gt;</strong>
&lt;ul&gt;
&lt;?pl for my $item (@$items) { ?&gt;
  &lt;li&gt;[=$item=]&lt;/li&gt;
&lt;?pl } ?&gt;
&lt;/ul&gt;
<strong>&lt;?pl stop_capture(); ?&gt;</strong>
</pre>
<p>'<code>start_placeholder()</code>' and '<code>stop_placeholder()</code>' are pre-defined helper macros.
For example,
</p>
<pre class="program">&lt;?pl <strong>start_placeholder('header_part')</strong>; ?&gt;
   &lt;img src="img/logo.png" alt="logo" ?&gt;
&lt;?pl <strong>stop_placeholder()</strong>; ?&gt;
</pre>
<p>is equivarent to the following.
</p>
<pre class="program">&lt;?pl <strong>if (defined($_context-&gt;{'header-part'})) {</strong> ?&gt;
&lt;?pl     <strong>push(@_buf, $_context-&gt;{'header_part'});</strong> ?&gt;
&lt;?pl <strong>} else {</strong> ?&gt;
   &lt;img src="img/logo.png" alt="logo" ?&gt;
&lt;?pl <strong>}</strong> ?&gt;
</pre>
<p>The following is the result. It shows that footer part in baselayout is overrided by other templates.
</p>
<a name="ex9_inherit.result"></a>
<div class="terminal_caption">
Result:</div>
<pre class="terminal">$ pltenjin -c "items=&gt;['AAA', 'BBB', 'CCC']" ex9-content.plhtml
&lt;html&gt;
 &lt;body&gt;

  &lt;div id="header"&gt;
   &lt;img src="img/logo.png" alt="logo" ?&gt;
  &lt;/div&gt;

  &lt;div id="content"&gt;
&lt;ul&gt;
  &lt;li&gt;AAA&lt;/li&gt;
  &lt;li&gt;BBB&lt;/li&gt;
  &lt;li&gt;CCC&lt;/li&gt;
&lt;/ul&gt;
  &lt;/div&gt;

  &lt;div id="footer"&gt;
&lt;address style="text-align:right"&gt;
  copyright&amp;copy; 2007 kuwata-lab all rights reserved&lt;br /&gt;
  &lt;a href="webmaster&amp;#64;kuwata-lab.com"&gt;webmaster&amp;#64;kuwata-lab.com&lt;/a&gt;
&lt;/address&gt;
  &lt;/div&gt;
  
 &lt;/body&gt;
&lt;/html&gt;
</pre>
<br>


<br>


<a name="faq-performance"></a>
<h2 class="section1">Performance</h2>
<a name="How fast is plTenjin compared with other solutions?"></a>
<h3 class="section2">How fast is plTenjin compared with other solutions?</h3>
<p>plTenjin contains benchmark script.
This shows that plTenjin works much faster than other solutions.
</p>
<div class="terminal_caption">
MacOS X 10.4 Tiger, Intel CoreDuo 1.83GHz, Memory 2GB</div>
<pre class="terminal">$ cd pltenjin-X.X.X/benchmark
$ perl -v | grep built
This is perl, v5.8.8 built for darwin-2level
$ perl -I ../lib bench.pl -n 10000 
*** n = 10000
                         user         sys       total        real
tenjin                  9.8500      0.5700     10.4200     11.0000
tenjin-nocache         16.2500      0.4300     16.6800     17.0000
tenjin-reuse            5.7100      0.0100      5.7200      6.0000
tt                    102.6100      0.9700    103.5800    104.0000
tt-reuse               26.2500      0.0500     26.3000     26.0000
htmltmpl               46.2300      0.4700     46.7000     47.0000
htmltmpl-reuse         30.1700      0.0400     30.2100     31.0000
</pre>
<p>In addition, module size of plTenjin is small, and it is very light-weight to import it.
This is important for CGI program.
Other solutions may be very heavy to import the module and suitable only for apache module or FastCGI.
</p>
<br>


<a name="faq-why-so-fast"></a>
<h3 class="section2">Why plTenjin is so fast?</h3>
<p>Because it doesn't use template engine original language.
</p>
<p>Other template engines, such as Template-Toolkit(perl), Django(python), or Smarty(php),
has their original languages.
This is not good idea for script language because:
</p>
<ul type="disc">
<li>They are slow.
</li>
<li>Implementation will be complex.
</li>
<li>Learning cost is high.
</li>
</ul>
<p>In addition, plTenjin is faster than Jakarta Velocity which is a very popular template engine in Java.
(It means that dynamic Java is slower than script languages.)
</p>
<p>Template engine should use their host language directly unless there are some kind of reasons.
</p>
<br>


<a name="faq-performance-tuning"></a>
<h3 class="section2">Is there any way to get more speed?</h3>
<p>'Tenjin::Template::defun(<em>funcname</em>, <em>args</em>, ...)' generates definition of subroutine.
This may make plTenjin faster.
</p>
<a name="ex10.pl"></a>
<div class="program_caption">
File 'ex10.pl':</div>
<pre class="program">use Tenjin;
my $template = new Tenjin::Template('ex10.plhtml');
my $defun = <strong>$template-&gt;defun('render_ex10', qw(title items))</strong>;
print $defun;
</pre>
<a name="ex10.plhtml"></a>
<div class="program_caption">
File 'ex10.plhtml':</div>
<pre class="program">&lt;html&gt;
 &lt;body&gt;
  &lt;h1&gt;[=$title=]&lt;/h1&gt;
  &lt;ul&gt;
  &lt;?pl for my $item (@$items) { ?&gt;
   &lt;li&gt;[=$item=]&lt;/li&gt;
  &lt;/ul&gt;
  &lt;?pl } ?&gt;
 &lt;/body&gt;
&lt;/html&gt;
</pre>
<a name="ex10_defun.result"></a>
<div class="terminal_caption">
Result:</div>
<pre class="terminal">$ perl ex10.pl
sub render_ex10 { my ($_context) = @_; my $title = $_context-&gt;{'title'}; my $items = $_context-&gt;{'items'}; my @_buf = (); push(@_buf, q`&lt;html&gt;
 &lt;body&gt;
  &lt;h1&gt;`, escape($title), q`&lt;/h1&gt;
  &lt;ul&gt;
`, );   for my $item (@$items) {
push(@_buf, q`   &lt;li&gt;`, escape($item), q`&lt;/li&gt;
  &lt;/ul&gt;
`, );   }
push(@_buf, q` &lt;/body&gt;
&lt;/html&gt;
`, ); join('', @_buf);
}
</pre>
<br>


<br>



   </div>
  </blockquote>

 </body>
</html>
